# K3s Production Configuration
# Environment-specific configuration for K3s deployment

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: crypto-core-config
  namespace: crypto-core-production
data:
  # Environment Settings
  ENVIRONMENT: "production"
  LOG_LEVEL: "INFO"
  DEBUG: "false"
  
  # Service Discovery (K3s internal DNS)
  MYSQL_HOST: "host.k3d.internal"  # Host MySQL server (outside K3d)
  REDIS_HOST: "host.k3d.internal"  # Host Redis server (outside K3d)
  
  # Database Configuration
  MYSQL_PORT: "3306"
  MYSQL_DATABASE: "crypto_prices"
  REDIS_PORT: "6379"
  
  # Collection Intervals (production optimized)
  NEWS_COLLECTION_INTERVAL: "300"        # 5 minutes
  SENTIMENT_PROCESSING_INTERVAL: "600"   # 10 minutes  
  TECHNICAL_CALCULATION_INTERVAL: "900"  # 15 minutes
  MACRO_ECONOMIC_INTERVAL: "3600"        # 1 hour
  ONCHAIN_DATA_INTERVAL: "1800"          # 30 minutes
  PRICE_COLLECTION_INTERVAL: "60"        # 1 minute
  
  # Performance Settings
  MAX_CONCURRENT_REQUESTS: "50"
  CONNECTION_POOL_SIZE: "20"
  TIMEOUT_SECONDS: "30"
  RETRY_ATTEMPTS: "3"
  
  # Feature Flags
  BACKFILL_ENABLED: "true"
  SENTIMENT_ANALYSIS_ENABLED: "true"
  TECHNICAL_INDICATORS_ENABLED: "true"
  ML_PIPELINE_ENABLED: "true"
  
  # API Rate Limiting
  API_RATE_LIMIT: "1000"
  API_RATE_WINDOW: "3600"

---
# Secrets Template (update with actual values before deployment)
apiVersion: v1
kind: Secret
metadata:
  name: crypto-core-secrets
  namespace: crypto-core-production
type: Opaque
data:
  # Database credentials (base64 encoded)
  mysql-user: bmV3c19jb2xsZWN0b3I=        # news_collector
  mysql-password: OTlSdWxlcyE=            # 99Rules!
  mysql-root-password: OTlSdWxlcyE=       # 99Rules!
  redis-password: OTlSdWxlcyE=            # 99Rules!
  
  # API Keys (REPLACE with your actual base64 encoded keys)
  coingecko-api-key: WU9VUl9DT0lOR0VDS09fS0VZ      # YOUR_COINGECKO_KEY
  newsapi-key: WU9VUl9ORVdTX0FQSV9LRVk=           # YOUR_NEWS_API_KEY
  polygon-api-key: WU9VUl9QT0xZR09OX0FQSV9LRVk=    # YOUR_POLYGON_API_KEY
  
  # Internal Service Authentication
  api-gateway-secret: WU9VUl9BUElfR0FURVdBWV9TRUNSRVQ= # YOUR_API_GATEWAY_SECRET

---
# Infrastructure Secrets
apiVersion: v1
kind: Secret
metadata:
  name: mysql-credentials
  namespace: crypto-infrastructure
type: Opaque
data:
  root-password: OTlSdWxlcyE=     # 99Rules!
  username: bmV3c19jb2xsZWN0b3I=  # news_collector  
  password: OTlSdWxlcyE=          # 99Rules!

---
apiVersion: v1
kind: Secret
metadata:
  name: redis-credentials
  namespace: crypto-infrastructure
type: Opaque
data:
  password: OTlSdWxlcyE=          # 99Rules!