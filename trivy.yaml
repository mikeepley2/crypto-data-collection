# Trivy configuration for crypto-data-collection
# Optimized for ML/data science containers

# Scanner settings
scanners:
  - vuln
  - misconfig
  - secret

# Package types (replaces deprecated vulnerability.type)
pkg:
  types:
    - os
    - library

# Vulnerability settings  
vulnerability:
  severity:
    - CRITICAL
    - HIGH
    - MEDIUM
  ignore-unfixed: true

# Performance settings
timeout: 30m
cache:
  ttl: 6h

# Output settings
format: table
quiet: false

# Skip certain checks for performance and PyTorch compatibility
skip:
  dirs:
    - "/usr/local/lib/python*/site-packages/scipy.libs"
    - "/usr/local/lib/python*/site-packages/numpy.libs"
    - "/usr/local/lib/python*/site-packages/torch/lib"
    - "/usr/local/lib/python*/site-packages/tensorflow"
    - "/root/.cache"
    - "/tmp"
    - "/var/cache"
  files:
    - "**/*.so.*"
    - "**/*.whl"
    - "**/libscipy_openblas*.so"
    - "**/libtorch*.so"
    - "**/libtorch_cuda*.so"
    - "**/*.safetensors"
    - "**/*.bin"

# License scanning (optional)
license:
  full: false

# Secret scanning settings
secret:
  skip-dirs:
    - "/usr/local/lib/python*/site-packages"
    - "/root/.cache"

# Misconfiguration scanning
misconfig:
  include-non-failures: false
  skip-files:
    - "**/*.so"
    - "**/*.bin"